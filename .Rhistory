install.packages('rsconnect')
rsconnect::setAccountInfo(name='datruccone', token='726717D6BA1FEB4B623695B5191ABBBB', secret='q+RTI8EhYq+AJixI1oOTv8YisX4lhhsYzk40uWUg')
library(rsconnect)
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution/R/')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution/R/PortfolioEvolution_Public.R')
rsconnect::deployApp('c:\Users\David\Documents\GitHub\PortfolioEvolution\R\PortfolioEvolution_Public.R')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution/')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution/')
library(rsconnect)
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution/')
rsconnect::setAccountInfo(name='datruccone', token='726717D6BA1FEB4B623695B5191ABBBB', secret='q+RTI8EhYq+AJixI1oOTv8YisX4lhhsYzk40uWUg')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution/')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution')
rsconnect::deployApp('c:/Users/David/Documents/GitHub/PortfolioEvolution')
#library(packrat)
#library(quantmod)
library(tidyverse)
library(data.table)
library("xlsx")
library(dplyr)
library(BatchGetSymbols)
library("ggplot2")
library(grDevices)
library(hrbrthemes) #Themes for ggplot2
cat("\f")
#degiro_csv_link <- readClipboard()
degiro_csv_link <- readline(prompt="Paste Degiro's CSV link: ")  # For Shiny version
degiro_csv_fromDate <- readline(prompt="Enter From Date in YYYY-MM-DD Format: ") # For Shiny version
degiro_csv_toDate <- readline(prompt="Enter To Date in YYYY-MM-DD Format: ") # For Shiny version
days = degiro_csv_toDate - degiro_csv_fromDate
days = as.date(degiro_csv_toDate) - as.date(degiro_csv_fromDate)
days = as.Date(degiro_csv_toDate) - as.Date(degiro_csv_fromDate)
as.Date(degiro_csv_toDate) - as.Date(degiro_csv_fromDate)
days <- as.Date(degiro_csv_toDate) - as.Date(degiro_csv_fromDate)
DAYS
days
days <- as.integer(as.Date(degiro_csv_toDate) - as.Date(degiro_csv_fromDate))
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
degiro_csv_date <- degiro_csv_fromDate
degiro_csv_link <- paste0(substr(degiro_csv_link,1, degiro_csv_link-14),substr(degiro_csv_date,9, 11),"%2F",substr(degiro_csv_date,6, 8),"%2F",substr(degiro_csv_date,1, 4))
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 11),"%2F",substr(degiro_csv_date,6, 8),"%2F",substr(degiro_csv_date,1, 4))
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 11),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,10, 11),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
View(CSV_Degiro)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- 0
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.Date(), Product = as.character(), Symbol/ISIN = as.character(), Amount = as.double(), Closing = as.double(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.Date(), Product = as.character(), 'Symbol/ISIN' = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.character(), Product = as.character(), 'Symbol/ISIN' = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
degiro_csv_date <- degiro_csv_fromDate
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,10, 11),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-13),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-15),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-12),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
#degiro_csv_link <- readClipboard()
degiro_csv_link <- readline(prompt="Paste Degiro's CSV link: ")  # For Shiny version
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-12),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
#degiro_csv_link <- readClipboard()
degiro_csv_link <- readline(prompt="Paste Degiro's CSV link: ")  # For Shiny version
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
View(Portfolio_Daily)
Portfolio_Daily$Date <- as.Date(Portfolio_Daily$Date)
Portfolio_Daily <- Portfolio_Daily[order(-Portfolio_Daily$Date),]
degiro_csv_date <- degiro_csv_date %m+% days(1)
library(lubridate)
degiro_csv_date <- degiro_csv_date %m+% days(1)
degiro_csv_date <- degiro_csv_date %d+% days(1)
degiro_csv_date <- degiro_csv_date %m+% day(1)
degiro_csv_date <- as.Date(degiro_csv_date) %m+% day(1)
degiro_csv_date <- as.Date(degiro_csv_date) %m+% days(1)
#Delete CSV Data Frame
rm(CSV_Degiro)
#setwd('c:/Path/to/your/folder')
#load("Portfolio Evolution.RData")  #Optional
rm(list = ls(all.names = TRUE))
cat("\f")
#degiro_csv_link <- readClipboard()
degiro_csv_link <- readline(prompt="Paste Degiro's CSV link: ")  # For Shiny version
degiro_csv_fromDate <- readline(prompt="Enter From Date in YYYY-MM-DD Format: ") # For Shiny version
degiro_csv_toDate <- readline(prompt="Enter To Date in YYYY-MM-DD Format: ") # For Shiny version
days = as.integer(as.Date(degiro_csv_toDate) - as.Date(degiro_csv_fromDate))
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.character(), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
degiro_csv_date <- degiro_csv_fromDate
for (i in days){
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
degiro_csv_date <- as.Date(degiro_csv_date) %m+% days(1)
#Delete CSV Data Frame
rm(CSV_Degiro)
#END IMPORT
}
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.character(), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
degiro_csv_date <- degiro_csv_fromDate
for (i in 1:days){
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
degiro_csv_date <- as.Date(degiro_csv_date) %m+% days(1)
#Delete CSV Data Frame
rm(CSV_Degiro)
#END IMPORT
}
View(Portfolio_Daily)
Portfolio_Daily$Date <- as.Date(Portfolio_Daily$Date)
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
View(CSV_Degiro)
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
degiro_csv_date <- as.Date(degiro_csv_date) %m+% days(1)
#Delete CSV Data Frame
rm(CSV_Degiro)
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.character(), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Delete CSV Data Frame
rm(CSV_Degiro)
degiro_csv_date <- degiro_csv_fromDate
degiro_csv_date <- as.Date(degiro_csv_fromDate)
for (i in 1:days){
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
degiro_csv_date <- as.Date(degiro_csv_date) %m+% days(1)
#Delete CSV Data Frame
rm(CSV_Degiro)
#END IMPORT
}
View(Portfolio_Daily)
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.Date(), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.Date(format = "%Y-%m-%d"), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.Date("2000-01-01",format = "%Y-%m-%d"), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.Date("",format = "%Y-%m-%d"), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.character(), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
#Check if Degiro CSV's hasn't been already imported to our Portfolio Daily dataframe...
#if (degiro_csv_date %!in% Portfolio_Daily$Date)
#{
#...if not, start with CSV file import
Portfolio_Daily <- data.frame(Date = as.character(), Product = as.character(), ISIN = as.character(), Amount = as.numeric(), Closing = as.numeric(), Localvalue = as.character(), ValueinEUR = as.character())
degiro_csv_date <- degiro_csv_fromDate
for (i in 1:days){
degiro_csv_link <- paste0(substr(degiro_csv_link,1, nchar(degiro_csv_link)-14),substr(degiro_csv_date,9, 10),"%2F",substr(degiro_csv_date,6, 7),"%2F",substr(degiro_csv_date,1, 4))
CSV_Degiro <- fread(degiro_csv_link)
CSV_Degiro$Date <- degiro_csv_date
CSV_Degiro <- CSV_Degiro[,c(7,1:6)]
#Append to Portfolio Daily history
Portfolio_Daily <- rbind(Portfolio_Daily,CSV_Degiro,use.names=FALSE)
degiro_csv_date <- as.character(as.Date(degiro_csv_date) %m+% days(1))
#Delete CSV Data Frame
rm(CSV_Degiro)
#END IMPORT
}
Portfolio_Daily$Date <- as.Date(Portfolio_Daily$Date)
Portfolio_Evolution <- data.frame(aggregate(Portfolio_Daily[7],list(Portfolio_Daily$Date),sum))
Portfolio_Evolution <- data.frame(aggregate(Portfolio_Daily[7],list(Portfolio_Daily[1]),sum))
Portfolio_Daily[7]
Portfolio_Daily[1]
Portfolio_Evolution <- data.frame(aggregate(Portfolio_Daily$ValueinEUR,list(Portfolio_Daily$Date),sum))
Portfolio_Daily$ValueinEUR
list(Portfolio_Daily$Date)
aggregate(Portfolio_Daily$ValueinEUR,list(Portfolio_Daily$Date),sum)
help(aggregate)
Portfolio_Evolution <- data.frame(aggregate(Portfolio_Daily$ValueinEUR,list(Portfolio_Daily$Date),sum,na.rm = TRUE))
Portfolio_Evolution <- data.frame(aggregate(as.numeric(Portfolio_Daily$ValueinEUR),list(Portfolio_Daily$Date),sum))
View(Portfolio_Evolution)
Portfolio_Daily$ValueinEUR
as.numeric(Portfolio_Daily$ValueinEUR)
as.double(Portfolio_Daily$ValueinEUR)
as.float(Portfolio_Daily$ValueinEUR)
#setwd('c:/Path/to/your/folder')
#load("Portfolio Evolution.RData")  #Optional
commarep <- function(c) {sub(",",".",c)}
Portfolio_Evolution <- data.frame(aggregate(as.numeric(commarep(Portfolio_Daily$ValueinEUR)),list(Portfolio_Daily$Date),sum,na.rm=TRUE))
View(Portfolio_Evolution)
names(Portfolio_Evolution)[1:2] <- c("Date","Portfolio")
Portfolio_Evolution$Date <- as.Date(Portfolio_Evolution$Date)
Portfolio_Evolution$HPR <- 0 #Add Holding Return Period column, which is basically the Portfolio gains/losses minus deposits and withdrawals
#Search for movements in Degiro Account
Cashflow_Degiro <- data.frame(subset(Cashflow[c(1,3)],Cashflow$Account == "Degiro"))
